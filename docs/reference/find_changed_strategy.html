<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find brain areas that meet the criteria for analysis of strategy across groups — find_changed_strategy • abc4d</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Find brain areas that meet the criteria for analysis of strategy across groups — find_changed_strategy" />
<meta property="og:description" content="Evaluation of the rate of change in count and intensity across brain areas. The criterion is set by
two conditions: first condition based on consistency (i.e. change in the same direction across samples), and the
second condition based on effect sizes (i.e. minimum effect size for the rate of change to be of interest). The function
outputs a dataframe with the comparison performed, the brain area (&quot;my_grouping&quot;) and towards which strategy (more intensity
 or more count) the brain area met the criteria." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">abc4d</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/abc4d.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/01_cleandata.html">01 - Data cleaning</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find brain areas that meet the criteria for analysis of strategy across groups</h1>
    
    <div class="hidden name"><code>find_changed_strategy.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Evaluation of the rate of change in count and intensity across brain areas. The criterion is set by
two conditions: first condition based on consistency (i.e. change in the same direction across samples), and the
second condition based on effect sizes (i.e. minimum effect size for the rate of change to be of interest). The function
outputs a dataframe with the comparison performed, the brain area ("my_grouping") and towards which strategy (more intensity
 or more count) the brain area met the criteria.</p>
    </div>

    <pre class="usage"><span class='fu'>find_changed_strategy</span><span class='op'>(</span>
  <span class='va'>region_df</span>,
  <span class='va'>consistency_n_samples</span>,
  <span class='va'>comparison_group</span>,
  min_change_rate <span class='op'>=</span> <span class='fl'>1</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>region_df</th>
      <td><p>region_based dataframe. Each row is a brain area ("my_grouping") per sample ("sample_id"), where
corrected cell count ("cells_perthousand") and average maximum intensity of the protein of interest ("intensity")
have been summarized. These variables have been preprocessed to "cells_perthousand_box_scaled" and "intensity_box_scaled".
The samples belong to experimental groups ("group") and were processed in batches ("batch", i.e. one sample per group).
This data frame can be the output of preprocess_per_region().</p></td>
    </tr>
    <tr>
      <th>consistency_n_samples</th>
      <td><p>number of samples which require to have consistent results in (at least one)
experimental group.</p></td>
    </tr>
    <tr>
      <th>comparison_group</th>
      <td><p>group against which comparison are made.</p></td>
    </tr>
    <tr>
      <th>min_change_rate</th>
      <td><p>minimum change in rate between comparison and experimental groups. Defaults to 1, i.e. any change.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    



    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># prepare dataframe</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>
batch <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>2</span><span class='op'>)</span>, each <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>,
group <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"control"</span>, <span class='st'>"exp"</span>, <span class='st'>"exp"</span>, <span class='st'>"control"</span><span class='op'>)</span>, each <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>,
sample_id <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"a"</span>, <span class='st'>"b"</span>, <span class='st'>"c"</span>, <span class='st'>"d"</span><span class='op'>)</span>, each <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span>,
my_grouping <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"CA1"</span>, <span class='st'>"CA2"</span>, <span class='st'>"CA3"</span>, <span class='st'>"DG"</span>, <span class='st'>"BLA"</span><span class='op'>)</span>, <span class='fl'>4</span><span class='op'>)</span>,
intensity <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>10000</span>, <span class='fl'>20</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
cells_perthousand <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>20</span><span class='op'>)</span><span class='op'>)</span>
<span class='op'>)</span>
<span class='va'>x</span><span class='op'>$</span><span class='va'>intensity_box_scaled</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>intensity</span><span class='op'>)</span>
<span class='va'>x</span><span class='op'>$</span><span class='va'>cells_perthousand_box_scaled</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/scale.html'>scale</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>cells_perthousand</span><span class='op'>)</span>

<span class='va'>y</span> <span class='op'>&lt;-</span> <span class='fu'>find_changed_strategy</span><span class='op'>(</span><span class='va'>x</span>, <span class='fl'>2</span>, <span class='st'>"control"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in region_df %&gt;% dplyr::mutate(group = ifelse(group == comparison_group,     "base", as.character(group))) %&gt;% dplyr::group_by(my_grouping,     batch, group) %&gt;% dplyr::summarize(count = median(cells_perthousand_box_scaled,     na.rm = T), intensity = median(intensity_box_scaled, na.rm = T)) %&gt;%     tidyr::pivot_wider(id_cols = c(my_grouping, batch), names_from = group,         values_from = c(count, intensity)) %&gt;% dplyr::mutate(dplyr::across(dplyr::starts_with("count_"),     ~{        .x - count_base    }), dplyr::across(dplyr::starts_with("intensity_"), ~{    .x - intensity_base})) %&gt;% dplyr::select(-c(count_base, intensity_base)) %&gt;% dplyr::select(my_grouping,     batch, starts_with("count_"), starts_with("intensity_")) %&gt;%     tidyr::pivot_longer(cols = -c(my_grouping, batch), names_to = "comparison",         values_to = "difference") %&gt;% tidyr::separate(comparison,     into = c("type", "diff")) %&gt;% tidyr::pivot_wider(names_from = type,     values_from = difference) %&gt;% dplyr::mutate(rate = count/intensity) %&gt;%     dplyr::mutate(ba_group = paste(my_grouping, diff, sep = "_")): could not find function "%&gt;%"</span></div><div class='input'><span class='va'>z</span> <span class='op'>&lt;-</span> <span class='fu'>find_changed_strategy</span><span class='op'>(</span><span class='va'>x</span>, <span class='fl'>2</span>, <span class='st'>"control"</span>, <span class='fl'>2</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='error'>Error in region_df %&gt;% dplyr::mutate(group = ifelse(group == comparison_group,     "base", as.character(group))) %&gt;% dplyr::group_by(my_grouping,     batch, group) %&gt;% dplyr::summarize(count = median(cells_perthousand_box_scaled,     na.rm = T), intensity = median(intensity_box_scaled, na.rm = T)) %&gt;%     tidyr::pivot_wider(id_cols = c(my_grouping, batch), names_from = group,         values_from = c(count, intensity)) %&gt;% dplyr::mutate(dplyr::across(dplyr::starts_with("count_"),     ~{        .x - count_base    }), dplyr::across(dplyr::starts_with("intensity_"), ~{    .x - intensity_base})) %&gt;% dplyr::select(-c(count_base, intensity_base)) %&gt;% dplyr::select(my_grouping,     batch, starts_with("count_"), starts_with("intensity_")) %&gt;%     tidyr::pivot_longer(cols = -c(my_grouping, batch), names_to = "comparison",         values_to = "difference") %&gt;% tidyr::separate(comparison,     into = c("type", "diff")) %&gt;% tidyr::pivot_wider(names_from = type,     values_from = difference) %&gt;% dplyr::mutate(rate = count/intensity) %&gt;%     dplyr::mutate(ba_group = paste(my_grouping, diff, sep = "_")): could not find function "%&gt;%"</span></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Valeria Bonapersona.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


