# abc4d

<!-- badges: start -->
![version](https://img.shields.io/github/r-package/v/valeriabonapersona/abc4d)
<!-- badges: end -->

**abc4d** is a pipeline to preprocess and analyze whole-brain microscopy data (over time). You have identified your active cells and aligned them to an atlas and wonder "What next?", **abc4d** is the place where to start. 


<br>
<p align="center">
  <img src="man/figures/logo.svg" width = 50% height = 50%>
</p>
<br>

abc4d has functions for: 
1) quality control, 
2) preprocessing, and 
3) analyses from the macro- to micro- scale. 

The resources offered within the package are in alignment of the Allen Brain Reference Atlas. However, for most functions these can be easily substituted.


## Get started

You can install the released version of abc4d from [github](https://github.com/valeriabonapersona/abc4d) with:

``` r
#If you do not have devtools yet:
#install.packages("devtools")

devtools::install_github("valeriabonapersona/abc4d")
```

All dependencies will be automatically downloaded.

## Basic example

``` r
library(abc4d)

# clean coordinates of one sample

# from coordinates (all_cells) to region-based dataset
region_raw <- summarize_per_region(all_cells, cell_atlas)

# preprocessing transformations (normalization, standardization, batch effects' corrections)
region_df <- preprocess_per_region(region_raw)

# pairwaise comparisons of cfos+ cell counts per brain area
res <- pairwise_activation(region_df)

# find most active brain areas
most_active <- find_most_active(region_df)

# simulation of most active under the null-hypothesis
sim_expression <- sim_most_active(weights, samples_per_group = 9, 
                                  n_exp = 1000, summary = TRUE)

# time: order brain areas based on their activation
order_ba <- order_brain_areas(region_df, groups)

# categorize brain areas based on their strategy
strategy_ba <- categorize_strategy(region_df, "0", "lm")

# check whether strategy changes in the experimental groups
res <- find_changed_strategy(region_df, 6, "0", 2)




```

## Tutorials
See 'Articles'. 

## Cheatsheet
<br>
<p align="center">
  <img src="man/figures/cheatsheet.svg">
</p>
<br>


More thorough tutorials are available [here](google.com). You can also see [this repository](https://github.com/valeriabonapersona/footshock_brain) for a thorough analysis example using the abc4d package.


## Project organization
This package was created with [devtools](https://cran.r-project.org/web/packages/devtools/index.html) and it follows the recommended organization.

```
.
├── .gitignore
├── CITATION.md
├── LICENSE.md
├── README.md
├── DESCRIPTION
├── NAMESPACE
├── R                     <- Source code of all functions
├── img                   <- Images for readme
├── man                   <- Automatically generated by roxygen2
├── tests                 <- Automatically generated by test_that
│   └── testthat          <- Tests to run on the functions
│   ├── final             <- The final, canonical data sets used for analyses. 
│   ├── raw               <- The original data, directly downloaded from the repository. 
│   └── temp              <- Intermediate data.
└── renv


```

## Known bugs
Nothing so far!

<br>

## License
This project is licensed under the terms of the [MIT License](/LICENSE.md).

<br>

## Citation
Please [cite this project as described here](/CITATION.md).

<br>

## Acknowledgements
* Heike Schuler for her collaboration in determining quality control and preprocessing steps
* Keving Kemna for suggesting making this package
